<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cb.basedata.mapper.CleanTblMapper">
    <select id="selectTablePrimaryKeyColumn" resultType="java.lang.String">
        select
            wm_concat ( b.column_name ) pk_columns
        from
            all_constraints a,
            all_cons_columns b
        where
            a.constraint_type = 'P'
          and a.owner = #{owner}
          and a.table_name = #{tableName}
          and b.owner = a.owner
          and a.table_name = b.table_name
        group by
            a.owner,
            a.table_name;
    </select>


    <select id="selectDataList" resultType="java.util.Map">
        select ${columns} from ${tableName} where ${condition}
    </select>
    <select id="streamQueryDataList" fetchSize="-2147483648" resultSetType="FORWARD_ONLY" resultType="java.util.Map">
        select ${columns} from ${tableName} where ${condition}
    </select>
    <select id="selectData" resultType="java.util.Map">
        select ${columns} from ${tableName} where ${condition}
    </select>
    <select id="selectDiyList" resultType="java.util.Map">
        select * from ${diySql}<if test="whereSql != null and whereSql != ''"> ${whereSql} </if>
    </select>

    <insert id="insertDataToTable">
        INSERT INTO ${tableName}
        <foreach  index="key" collection="row" open="(" separator="," close=")">
            ${key}
        </foreach>
        values
        <foreach item="value" collection="row" open="(" separator="," close=")">
            #{value}
        </foreach>
    </insert>
    <update id="updateDataToTable">
        UPDATE ${tableName} SET
        <foreach item="item" index="key" collection="row" open="" separator="," close="">
            ${key}=#{item}
        </foreach>
        where ${condition}
    </update>


</mapper>
