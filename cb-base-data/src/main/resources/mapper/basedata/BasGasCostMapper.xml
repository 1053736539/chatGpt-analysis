<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cb.basedata.mapper.BasGasCostMapper">

    <resultMap type="BasGasCost" id="BasGasCostResult">
        <result property="id" column="id"/>
        <result property="sourceId"    column="source_id"    />
        <result property="userNumber" column="user_number"/>
        <result property="buildingCode" column="building_code"/>
        <result property="area" column="area"/>
        <result property="community" column="community"/>
        <result property="buildingNumber" column="building_number"/>
        <result property="unit" column="unit"/>
        <result property="roomNumber" column="room_number"/>
        <result property="address" column="address"/>
        <result property="paymentAmount" column="payment_amount"/>
        <result property="paymentTime" column="payment_time"/>
        <result property="paymentType" column="payment_type"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
        <result property="remark" column="remark"/>
        <result property="userName"    column="user_name"    />
        <result property="idCardNumber"    column="id_card_number"    />
        <result property="phoneNumber"    column="phone_number"    />
    </resultMap>

    <sql id="selectBasGasCostVo">
        select id,
               source_id,
               user_number,
               user_name,
               id_card_number,
               phone_number,
               building_code,
               area,
               community,
               building_number,
               unit,
               room_number,
               address,
               payment_amount,
               payment_time,
               payment_type,
               create_by,
               create_time,
               update_by,
               update_time,
               remark
        from bas_gas_cost
    </sql>

    <select id="selectBasGasCostList" parameterType="BasGasCost" resultMap="BasGasCostResult">
        <include refid="selectBasGasCostVo"/>
        <where>
            <if test="sourceId != null  and sourceId != ''"> and source_id = #{sourceId}</if>
            <if test="userNumber != null  and userNumber != ''"> and user_number = #{userNumber}</if>
            <if test="buildingCode != null  and buildingCode != ''"> and building_code = #{buildingCode}</if>
            <if test="area != null  and area != ''"> and area = #{area}</if>
            <if test="buildingNumber != null  and buildingNumber != ''"> and building_number = #{buildingNumber}</if>
            <if test="unit != null  and unit != ''"> and unit = #{unit}</if>
            <if test="community != null  and community != ''"> and community = #{community}</if>
            <if test="roomNumber != null  and roomNumber != ''"> and room_number = #{roomNumber}</if>
            <if test="address != null  and address != ''"> and address = #{address}</if>
            <if test="paymentAmount != null "> and payment_amount = #{paymentAmount}</if>
            <if test="paymentTime != null "> and payment_time = #{paymentTime}</if>
            <if test="paymentType != null  and paymentType != ''"> and payment_type = #{paymentType}</if>
            <if test="userName != null  and userName != ''"> and user_name like concat('%', #{userName}, '%')</if>
            <if test="idCardNumber != null  and idCardNumber != ''"> and id_card_number = #{idCardNumber}</if>
            <if test="phoneNumber != null  and phoneNumber != ''"> and phone_number = #{phoneNumber}</if>
        </where>
    </select>

    <select id="selectBasGasCostById" parameterType="String" resultMap="BasGasCostResult">
        <include refid="selectBasGasCostVo"/>
        where id = #{id}
    </select>
    <select id="checkExistence" parameterType="BasGasCost" resultMap="BasGasCostResult">
        <include refid="selectBasGasCostVo"/>
        <where>
            <if test="userNumber != null  and userNumber != ''">and user_number = #{userNumber}</if>
            <if test="buildingCode != null  and buildingCode != ''">and building_code = #{buildingCode}</if>
            <if test="buildingNumber != null  and buildingNumber != ''">and building_number = #{buildingNumber}</if>
            <if test="unit != null  and unit != ''">and unit = #{unit}</if>
            <if test="roomNumber != null  and roomNumber != ''">and room_number = #{roomNumber}</if>
            <if test="address != null  and address != ''">and address = #{address}</if>
            <if test="paymentTime != null ">and payment_time = #{paymentTime}</if>
        </where>
    </select>
    <select id="existBasGasCostBySourceId" resultType="java.lang.Boolean">
        select count(0) from bas_gas_cost where source_id = #{sourceId}
    </select>
    <select id="selectBasGasCostBySourceId" resultMap="BasGasCostResult">
        <include refid="selectBasGasCostVo"/>
        where source_id =#{sourceId}
        and create_time = (select max(create_time) from bas_gas_cost where source_id = #{sourceId})
    </select>
    <select id="selectAllBasGasCostList" resultMap="BasGasCostResult">
        <include refid="selectBasGasCostVo"/>
    </select>

    <insert id="insertBasGasCost" parameterType="BasGasCost">
        insert into bas_gas_cost
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null and id != ''">id,</if>
            <if test="sourceId != null and sourceId != ''">source_id,</if>
            <if test="userNumber != null and userNumber != ''">user_number,</if>
            <if test="buildingCode != null and buildingCode != ''">building_code,</if>
            <if test="area != null and area != ''">area,</if>
            <if test="buildingNumber != null and buildingNumber != ''">building_number,</if>
            <if test="unit != null and unit != ''">unit,</if>
            <if test="community != null and community != ''">community,</if>
            <if test="roomNumber != null and roomNumber != ''">room_number,</if>
            <if test="address != null and address != ''">address,</if>
            <if test="paymentAmount != null">payment_amount,</if>
            <if test="paymentTime != null">payment_time,</if>
            <if test="paymentType != null and paymentType != ''">payment_type,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="remark != null">remark,</if>
            <if test="userName != null">user_name,</if>
            <if test="idCardNumber != null">id_card_number,</if>
            <if test="phoneNumber != null">phone_number,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null and id != ''">#{id},</if>
            <if test="sourceId != null and sourceId != ''">#{sourceId},</if>
            <if test="userNumber != null and userNumber != ''">#{userNumber},</if>
            <if test="buildingCode != null and buildingCode != ''">#{buildingCode},</if>
            <if test="area != null and area != ''">#{area},</if>
            <if test="buildingNumber != null and buildingNumber != ''">#{buildingNumber},</if>
            <if test="unit != null and unit != ''">#{unit},</if>
            <if test="community != null and community != ''">#{community},</if>
            <if test="roomNumber != null and roomNumber != ''">#{roomNumber},</if>
            <if test="address != null and address != ''">#{address},</if>
            <if test="paymentAmount != null">#{paymentAmount},</if>
            <if test="paymentTime != null">#{paymentTime},</if>
            <if test="paymentType != null and paymentType != ''">#{paymentType},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="remark != null">#{remark},</if>
            <if test="userName != null">#{userName},</if>
            <if test="idCardNumber != null">#{idCardNumber},</if>
            <if test="phoneNumber != null">#{phoneNumber},</if>
        </trim>
    </insert>

    <update id="updateBasGasCost" parameterType="BasGasCost">
        update bas_gas_cost
        <trim prefix="SET" suffixOverrides=",">
            <if test="sourceId != null and sourceId != ''">source_id = #{sourceId},</if>
            <if test="userNumber != null and userNumber != ''">user_number = #{userNumber},</if>
            <if test="buildingCode != null and buildingCode != ''">building_code = #{buildingCode},</if>
            <if test="area != null and area != ''">area = #{area},</if>
            <if test="buildingNumber != null and buildingNumber != ''">building_number = #{buildingNumber},</if>
            <if test="unit != null and unit != ''">unit = #{unit},</if>
            <if test="community != null and community != ''">community = #{community},</if>
            <if test="roomNumber != null and roomNumber != ''">room_number = #{roomNumber},</if>
            <if test="address != null and address != ''">address = #{address},</if>
            <if test="paymentAmount != null">payment_amount = #{paymentAmount},</if>
            <if test="paymentTime != null">payment_time = #{paymentTime},</if>
            <if test="paymentType != null and paymentType != ''">payment_type = #{paymentType},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="userName != null">user_name = #{userName},</if>
            <if test="idCardNumber != null">id_card_number = #{idCardNumber},</if>
            <if test="phoneNumber != null">phone_number = #{phoneNumber},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteBasGasCostById" parameterType="String">
        delete
        from bas_gas_cost
        where id = #{id}
    </delete>

    <delete id="deleteBasGasCostByIds" parameterType="String">
        delete from bas_gas_cost where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>