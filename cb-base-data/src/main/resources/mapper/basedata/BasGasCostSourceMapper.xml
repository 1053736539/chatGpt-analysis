<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cb.basedata.mapper.BasGasCostSourceMapper">

    <resultMap type="BasGasCostSource" id="BasGasCostSourceResult">
        <result property="sourceId" column="source_id"/>
        <result property="manageUnit" column="manage_unit"/>
        <result property="userNumber" column="user_number"/>
        <result property="userName" column="user_name"/>
        <result property="address" column="address"/>
        <result property="idCardNumber" column="id_card_number"/>
        <result property="phoneNumber" column="phone_number"/>
        <result property="paymentAmount" column="payment_amount"/>
        <result property="paymentTime" column="payment_time"/>
        <result property="paymentType" column="payment_type"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
        <result property="remark" column="remark"/>
        <result property="isCleaning" column="is_cleaning"/>
    </resultMap>

    <sql id="selectBasGasCostSourceVo">
        select s.source_id,
               s.manage_unit,
               s.user_number,
               s.user_name,
               s.address,
               s.id_card_number,
               s.phone_number,
               s.payment_amount,
               s.payment_time,
               s.payment_type,
               s.create_by,
               s.create_time,
               s.update_by,
               s.update_time,
               s.remark,
               (select count(0) from bas_gas_cost where source_id = s.source_id )as is_cleaning
        from bas_gas_cost_source s
    </sql>

    <select id="selectBasGasCostSourceList" parameterType="BasGasCostSource" resultMap="BasGasCostSourceResult">
        <include refid="selectBasGasCostSourceVo"/>
        <where>
            <if test="manageUnit != null  and manageUnit != ''">and s.manage_unit = #{manageUnit}</if>
            <if test="userNumber != null  and userNumber != ''">and s.user_number = #{userNumber}</if>
            <if test="userName != null  and userName != ''">and s.user_name like concat('%', #{userName}, '%')</if>
            <if test="address != null  and address != ''">and s.address = #{address}</if>
            <if test="idCardNumber != null  and idCardNumber != ''">and s.id_card_number = #{idCardNumber}</if>
            <if test="phoneNumber != null  and phoneNumber != ''">and s.phone_number = #{phoneNumber}</if>
            <if test="paymentAmount != null ">and s.payment_amount = #{paymentAmount}</if>
            <if test="paymentTime != null ">and s.payment_time = #{paymentTime}</if>
            <if test="paymentType != null  and paymentType != ''">and s.payment_type = #{paymentType}</if>
        </where>
    </select>

    <select id="selectBasGasCostSourceById" parameterType="String" resultMap="BasGasCostSourceResult">
        <include refid="selectBasGasCostSourceVo"/>
        where s.source_id = #{sourceId}
    </select>
    <select id="checkExistence" resultMap="BasGasCostSourceResult">
        <include refid="selectBasGasCostSourceVo"/>
        <where>
            <if test="userNumber != null  and userNumber != ''">and s.user_number = #{userNumber}</if>
            <if test="idCardNumber != null  and idCardNumber != ''">and s.id_card_number = #{idCardNumber}</if>
            <if test="paymentTime != null ">and s.payment_time = #{paymentTime}</if>
        </where>
    </select>

    <insert id="insertBasGasCostSource" parameterType="BasGasCostSource">
        insert into bas_gas_cost_source
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="sourceId != null and sourceId != ''">source_id,</if>
            <if test="manageUnit != null and manageUnit != ''">manage_unit,</if>
            <if test="userNumber != null and userNumber != ''">user_number,</if>
            <if test="userName != null and userName != ''">user_name,</if>
            <if test="address != null and address != ''">address,</if>
            <if test="idCardNumber != null and idCardNumber != ''">id_card_number,</if>
            <if test="phoneNumber != null and phoneNumber != ''">phone_number,</if>
            <if test="paymentAmount != null">payment_amount,</if>
            <if test="paymentTime != null">payment_time,</if>
            <if test="paymentType != null and paymentType != ''">payment_type,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="remark != null">remark,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="sourceId != null and sourceId != ''">#{sourceId},</if>
            <if test="manageUnit != null and manageUnit != ''">#{manageUnit},</if>
            <if test="userNumber != null and userNumber != ''">#{userNumber},</if>
            <if test="userName != null and userName != ''">#{userName},</if>
            <if test="address != null and address != ''">#{address},</if>
            <if test="idCardNumber != null and idCardNumber != ''">#{idCardNumber},</if>
            <if test="phoneNumber != null and phoneNumber != ''">#{phoneNumber},</if>
            <if test="paymentAmount != null">#{paymentAmount},</if>
            <if test="paymentTime != null">#{paymentTime},</if>
            <if test="paymentType != null and paymentType != ''">#{paymentType},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="remark != null">#{remark},</if>
        </trim>
    </insert>

    <update id="updateBasGasCostSource" parameterType="BasGasCostSource">
        update bas_gas_cost_source
        <trim prefix="SET" suffixOverrides=",">
            <if test="manageUnit != null and manageUnit != ''">manage_unit = #{manageUnit},</if>
            <if test="userNumber != null and userNumber != ''">user_number = #{userNumber},</if>
            <if test="userName != null and userName != ''">user_name = #{userName},</if>
            <if test="address != null and address != ''">address = #{address},</if>
            <if test="idCardNumber != null and idCardNumber != ''">id_card_number = #{idCardNumber},</if>
            <if test="phoneNumber != null and phoneNumber != ''">phone_number = #{phoneNumber},</if>
            <if test="paymentAmount != null">payment_amount = #{paymentAmount},</if>
            <if test="paymentTime != null">payment_time = #{paymentTime},</if>
            <if test="paymentType != null and paymentType != ''">payment_type = #{paymentType},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="remark != null">remark = #{remark},</if>
        </trim>
        where source_id = #{sourceId}
    </update>

    <delete id="deleteBasGasCostSourceById" parameterType="String">
        delete
        from bas_gas_cost_source
        where source_id = #{sourceId}
    </delete>

    <delete id="deleteBasGasCostSourceByIds" parameterType="String">
        delete from bas_gas_cost_source where source_id in
        <foreach item="sourceId" collection="array" open="(" separator="," close=")">
            #{sourceId}
        </foreach>
    </delete>
</mapper>